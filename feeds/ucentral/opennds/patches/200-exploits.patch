Index: openNDS-9.0.0/src/http_microhttpd.c
===================================================================
--- openNDS-9.0.0.orig/src/http_microhttpd.c
+++ openNDS-9.0.0/src/http_microhttpd.c
@@ -531,7 +531,7 @@ static int try_to_authenticate(struct MH
 		debug(LOG_DEBUG, "client->token=%s tok=%s ", client->token, tok );
 
 		//Check if token (tok) or hash_id (hid) mode
-		if (strlen(tok) > 8) {
+		if (tok && strlen(tok) > 8) {
 			// hid mode
 			hash_str(hid, sizeof(hid), client->token);
 			safe_asprintf(&rhidraw, "%s%s", hid, config->fas_key);
